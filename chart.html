<!DOCTYPE>
<html>

<head>

<script src="http://code.highcharts.com/highcharts.js"></script>
<script src="http://code.highcharts.com/highcharts-more.js"></script>
<script src="https://rawgithub.com/highslide-software/draggable-points/master/draggable-points.js?1"></script>

<script type="text/javascript" src="./src/fuel-chart.js"></script>
<script type="text/javascript" src="./src/rocketEngine.js"></script>

<script type="text/javascript">

function onBodyLoad() {
    const fuelChart = getFuelChart('fuelChart');
    
    window.fuelChart = fuelChart;
    
    console.log(fuelChart);
    console.log(getFuelData(fuelChart).map(({ fuel }) => fuel));
}

function run() {
    const fuelConsumption = y => 1075;
    const gen = launch(fuelConsumption/*, 27000*/);
    let time;
    
    requestAnimationFrame(step);
    
    function step() {
        const diff = -(time || (time = Date.now() - 1)) + (time = Date.now());
        const state = gen.next(diff / 10);
        
        if (!state.done) {
            document.getElementById('res').textContent = JSON.stringify(state.value, null, '  ');
            requestAnimationFrame(step);
        }
    }
}

</script>

</head>

<body onload="onBodyLoad()">
    <div id="fuelChart" style="height: 300px"></div>
    <br>
    <div><button onclick="run()">Go!</button></div>
    <pre id="res"></pre>
</body>
